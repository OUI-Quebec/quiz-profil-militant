<div class="quiz-container">
  <!-- Header de progression toujours visible sauf sur la page de résultats -->
  @if (!progression().complete) {
  <app-progression-header />
  }

  <!-- Présentation de section -->
  <!-- Ajout de sectionActuelle() dans la condition pour éviter d'instancier le composant avec une section null
       (le chargement des sections est asynchrone, progression existe déjà) -->
  @if (!progression().complete && doitMontrerPresentationSection() &&
  sectionActuelle()) {
  <app-section-presentation
    [section]="sectionActuelle()"
    [numeroSection]="progression().sectionActuelle + 1"
    (commencer)="commencerSection()"
  />
  }

  <!-- Question -->
  @if (!progression().complete && !doitMontrerPresentationSection() &&
  questionActuelle()) {
  <app-question
    [question]="questionActuelle()"
    [peutRetourner]="peutRetourner()"
    (choixEffectue)="repondreQuestion($event)"
    (precedentDemande)="questionPrecedente()"
    (passerDemande)="passerQuestion()"
    (recommencerDemande)="recommencerQuiz()"
  />
  }

  <!-- Résultats -->
  @if (progression().complete && profils().length > 0) {
  <app-resultats [profils]="profils()" />
  }

  <!-- Footer toujours visible -->
  <app-footer />

  <!-- Dialogue de confirmation pour recommencer -->
  <app-dialog-confirmation
    [isVisible]="showDialogRecommencer()"
    titre="Recommencer le quiz"
    message="Es-tu sûr·e de vouloir recommencer le quiz ? Toute ta progression sera perdue."
    texteConfirmer="Recommencer"
    texteAnnuler="Annuler"
    (confirmer)="confirmerRecommencer()"
    (annuler)="annulerRecommencer()"
  />
</div>
